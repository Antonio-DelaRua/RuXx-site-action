<!-- interactive-image.html -->
<div class="interactive-container" [class.activated]="isActivated">
  <img 
    src="assets/robitroll.webp" 
    alt="Chatbot" 
    class="interactive-image"
    (click)="onImageClick($event)"
    (dblclick)="onDoubleClick($event)"
  >
  
  <div *ngIf="showHint" class="hint-message">
    {{ 'CHATBOX.HELP' | translate }}
  </div>

  <div *ngIf="isChatOpen" class="chat-bubble">
    <div class="chat-container">
      <div class="chat-header">
        <div class="chat-title">{{ 'CHATBOX.TITLE' | translate }}</div>
        <button class="close-btn" (click)="closeChat()">×</button>
      </div>
      
      <div #chatMessages class="chat-messages">
        <div *ngFor="let message of messages" 
             class="message" 
             [class.user]="message.startsWith('🧑‍💻')"
             [class.ai]="message.startsWith('🤖') || message.startsWith('⚠️')">
          {{ message }}
        </div>
        <div *ngIf="loading" class="message ai">
          Buscando información...
        </div>
      </div>
      
      <div class="chat-input-container">
        <input
          #chatInput
          type="text" 
          class="chat-input" 
          [(ngModel)]="chatMessage"
          (keypress)="onKeyPress($event)"
          [placeholder]="'CHATBOX.PLACEHOLDER' | translate"
          [disabled]="loading"
        >
        <button 
          class="send-btn" 
          (click)="sendMessage()"
          [disabled]="!chatMessage.trim() || loading"
        >
          {{ 'CHATBOX.SEND' | translate }}
        </button>
      </div>
    </div>
  </div>
</div>

<button 
  *ngIf="!isActivated"
  class="chatbot-toggle" 
  (click)="activateChatbot()"
>
  💬
</button>