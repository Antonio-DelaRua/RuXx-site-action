<!-- Botón circular del chatbot -->
<button 
  class="chatbot-toggle" 
  *ngIf="!isActivated" 
  (click)="activateChatbot()"
  title="Abrir asistente virtual"
>
  💬
</button>

<!-- Contenedor principal -->
<div 
  class="interactive-container" 
  [class.activated]="isActivated"
>
  <!-- Imagen del asistente -->
  <img 
    src="assets/robitroll.png"
    alt="Asistente virtual"
    class="interactive-image"
    (click)="onImageClick($event)"
    (dblclick)="onDoubleClick($event)"
  />
  
  <!-- Texto de ayuda temporal -->
  <div class="hint-message" *ngIf="showHint">
    {{ 'CHATBOX.HELP' | translate }}
  </div>
  
  <!-- Ventana de chat -->
  <div class="chat-bubble" *ngIf="isChatOpen">
    <div class="chat-container">
      <!-- Cabecera -->
      <div class="chat-header">
        <div class="chat-title">{{ 'CHATBOX.TITLE' | translate }}</div>
        <button class="close-btn" (click)="closeChat()">×</button>
      </div>
      
      <!-- Mensajes -->
      <div class="chat-messages" #chatMessages>
        <div 
          *ngFor="let message of messages" 
          class="message"
          [ngClass]="{
            'user': message.startsWith('🧑‍💻'),
            'ai': message.startsWith('🤖'),
            'error': message.startsWith('⚠️')
          }"
        >
          {{ message }}
        </div>

        <!-- Indicador de carga -->
        <div class="loading" *ngIf="loading">
          <div class="dot"></div>
          <div class="dot"></div>
          <div class="dot"></div>
        </div>
      </div>
      
      <!-- Entrada de texto -->
      <div class="chat-input-container">
        <input 
          type="text" 
          class="chat-input" 
          [placeholder]="'CHATBOX.PLACEHOLDER' | translate"
          [(ngModel)]="chatMessage"
          (keyup.enter)="sendMessage()"
        >
        <button 
          class="send-btn" 
          (click)="sendMessage()" 
          [disabled]="loading || !chatMessage.trim()"
        >
          {{ 'CHATBOX.SEND' | translate }}
        </button>
      </div>
    </div>
  </div>
</div>
