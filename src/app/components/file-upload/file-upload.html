<div class="full-screen-container">
<header class="page-header">
  <button class="back-home-btn" routerLink="/">
    ‚¨ÖÔ∏è Inicio
  </button>

  <div class="header-content">
    <h1 class="page-title">üìö Mis Audiolibros</h1>
  </div>
</header>

<main class="main-content">
  <!-- Loading -->
  <div *ngIf="isLoading" class="loading-section">
    <div class="loading-spinner">Cargando libros...</div>
  </div>

  <!-- Books Grid -->
<div *ngIf="!isLoading && books.length > 0" class="books-grid">
  <div
    *ngFor="let book of books"
    class="book-flip-container"
    [class.flipped]="selectedBook?.id === book.id && isPlaying"
  >
    <div class="book-flip-card">
      
      <!-- FRONT: portada -->
      <div class="book-front">
        <img [src]="book.image_url || '/assets/matatrolls.jpg'" [alt]="book.title" />
        <button class="flip-play-btn" (click)="playBook(book)">
          <i class="fas fa-play"></i>
        </button>
      </div>

      <!-- BACK: detalles, controles, etc -->
      <div class="book-back">
        <h3>{{ book.title }}</h3>
        <p>{{ book.description || 'Sin descripci√≥n disponible' }}</p>

        <div class="audio-controls-modern">
          <input
            type="range"
            class="audio-progress"
            min="0"
            [max]="audio.duration || 100"
            [value]="audio.currentTime || 0"
            (input)="seekAudio($event)"
          />

          <div class="time-display">
            <span>{{ formatTime(audio.currentTime || 0) }}</span>
            <span>{{ formatTime(audio.duration || 0) }}</span>
          </div>

          <div class="control-buttons">
            <button class="btn-control" (click)="rewindAudio()"><i class="fas fa-backward"></i></button>
            <button class="btn-control btn-play-main" (click)="playBook(book)">
              <i class="fas" [class]="isPlaying ? 'fa-pause' : 'fa-play'"></i>
            </button>
            <button class="btn-control" (click)="forwardAudio()"><i class="fas fa-forward"></i></button>
          </div>
        </div>

        <div class="btn-close-container">
          <button class="btn-close" (click)="stopAudio()">
            <i class="fas fa-undo"></i> 
          </button>
        </div>
      </div>
    </div>
  </div>
</div>


  <!-- Empty State -->
  <div *ngIf="!isLoading && books.length === 0 && !errorMessage" class="empty-state">
    <div class="empty-icon">üìö</div>
    <h3>No hay libros disponibles</h3>
    <p>Los libros se agregan manualmente al sistema.</p>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage" class="error-section">
    <div class="error-card">
      <div class="error-icon">‚ùå</div>
      <h4>Error</h4>
      <p>{{ errorMessage }}</p>
      <button class="btn btn-outline-primary mt-3" (click)="loadBooks()">
        Reintentar
      </button>
    </div>
  </div>
</main>
</div>