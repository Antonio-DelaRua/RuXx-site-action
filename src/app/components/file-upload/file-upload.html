<div class="full-screen-container">
  <header class="page-header">
    <div class="header-content">
      <h1 class="page-title">üìö Lector de Audiolibros</h1>
      <p class="page-subtitle">Convierte tus libros en audio con IA</p>
    </div>
  </header>

  <main class="main-content">
    <!-- √Årea de subida de archivos -->
    <div class="upload-section">
      <div class="upload-area">
        <div class="upload-icon">üìÑ</div>
        <h3>Selecciona tu archivo</h3>
        <p>Arrastra y suelta un archivo PDF o TXT, o haz clic para seleccionar</p>
        <input
          #fileInput
          type="file"
          class="file-input"
          (change)="onFileSelected($event)"
          accept=".pdf,.txt"
          [disabled]="isUploading"
        >
        <button
          type="button"
          class="btn btn-primary btn-lg upload-btn"
          (click)="fileInput.click()"
          [disabled]="isUploading"
        >
          <i class="fas fa-upload"></i> Seleccionar Archivo
        </button>
        <small class="file-formats">Formatos soportados: PDF y TXT (m√°x. 10MB)</small>
      </div>
    </div>

    <!-- Progress Bar -->
    <div *ngIf="isUploading" class="progress-section">
      <div class="progress-container">
        <div class="progress-header">
          <h4>Procesando tu archivo...</h4>
          <span class="progress-percentage">{{ uploadProgress }}%</span>
        </div>
        <div class="progress">
          <div
            class="progress-bar progress-bar-striped progress-bar-animated bg-success"
            [style.width]="uploadProgress + '%'"
          ></div>
        </div>
        <p class="progress-text">Extrayendo texto y generando audio...</p>
      </div>
    </div>

    <!-- Resultado del procesamiento -->
    <div *ngIf="uploadResult" class="result-section">
      <div class="result-card">
        <div class="result-header">
          <div class="success-icon">‚úÖ</div>
          <h3>¬°Archivo procesado exitosamente!</h3>
        </div>
        <div class="result-details">
          <div class="detail-item">
            <span class="detail-label">Archivo:</span>
            <span class="detail-value">{{ uploadResult.original_filename }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Texto extra√≠do:</span>
            <span class="detail-value">{{ uploadResult.text_length }} caracteres</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Vista previa:</span>
            <span class="detail-value text-preview">{{ uploadResult.text_preview }}</span>
          </div>
        </div>
      </div>

      <!-- Reproductor de audio -->
      <div class="audio-player-section">
        <h4>üéµ Tu Audiolibro</h4>
        <div class="card mt-3">
          <div class="card-header">
            <h5 class="card-title mb-0">üéµ {{ uploadResult.original_filename }}</h5>
          </div>
          <div class="card-body">
            <!-- Controles b√°sicos -->
            <div class="d-flex align-items-center mb-3">
              <button
                class="btn btn-outline-primary me-2"
                (click)="togglePlay()"
                [disabled]="!audioUrl"
              >
                {{ isPlaying ? '‚è∏Ô∏è Pausar' : '‚ñ∂Ô∏è Reproducir' }}
              </button>

              <button
                class="btn btn-outline-secondary me-2"
                (click)="stop()"
                [disabled]="!audioUrl"
              >
                ‚èπÔ∏è Detener
              </button>

              <span class="badge bg-info">{{ currentTimeFormatted }}</span>
              <span class="mx-2">/</span>
              <span class="badge bg-secondary">{{ durationFormatted }}</span>
            </div>

            <!-- Barra de progreso -->
            <div class="mb-3">
              <input
                type="range"
                class="form-range"
                [value]="currentTime"
                [max]="duration"
                (input)="seekTo($event)"
                [disabled]="!audioUrl"
              >
            </div>

            <!-- Controles de volumen -->
            <div class="row align-items-center">
              <div class="col-auto">
                <small class="text-muted">Volumen:</small>
              </div>
              <div class="col">
                <input
                  type="range"
                  class="form-range"
                  min="0" max="1" step="0.1"
                  [value]="volume"
                  (input)="setVolume($event)"
                >
              </div>
              <div class="col-auto">
                <span class="badge bg-light text-dark">{{ volume * 100 | number:'1.0-0' }}%</span>
              </div>
            </div>

            <!-- Estado -->
            <div *ngIf="!audioUrl" class="alert alert-warning mt-3">
              No hay audio disponible para reproducir
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Mensajes de error -->
    <div *ngIf="errorMessage" class="error-section">
      <div class="error-card">
        <div class="error-icon">‚ùå</div>
        <h4>Error al procesar el archivo</h4>
        <p>{{ errorMessage }}</p>
      </div>
    </div>
  </main>
</div>